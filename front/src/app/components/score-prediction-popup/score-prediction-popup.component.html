<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  styleClass="score-prediction-dialog"
  (onHide)="onHide()"
>
  <ng-template pTemplate="header">
    <h3>{{ isUpdating() ? "Update Prediction" : "Score Prediction" }}</h3>
  </ng-template>

  <form [formGroup]="predictionForm">
    <div class="prediction-container">
      <!-- Team 1 -->
      <div class="team-section">
        <div class="team-header">
          @if ( team1Flag()) {
          <img
            [src]="team1Flag()"
            [alt]="team1Name() + ' flag'"
            class="team-flag"
          />}
          <h4 class="team-name">{{ team1Name() }}</h4>
        </div>
        <div class="score-input-container">
          <label [for]="'team1-score'">Score</label>
          <p-inputNumber
            [inputId]="'team1-score'"
            formControlName="team1Score"
            [min]="0"
            [max]="99"
            [showButtons]="true"
            buttonLayout="horizontal"
            incrementButtonIcon="pi pi-plus"
            decrementButtonIcon="pi pi-minus"
            [step]="1"
            styleClass="score-input"
          >
          </p-inputNumber>
        </div>
      </div>

      <!-- VS Divider -->
      <div class="vs-divider">
        <span class="vs-text">VS</span>
      </div>

      <!-- Team 2 -->
      <div class="team-section">
        <div class="team-header">
          @if ( team2Flag()) {
          <img
            [src]="team2Flag()"
            [alt]="team2Name() + ' flag'"
            class="team-flag"
          />
          }
          <h4 class="team-name">{{ team2Name() }}</h4>
        </div>
        <div class="score-input-container">
          <label [for]="'team2-score'">Score</label>
          <p-inputNumber
            [inputId]="'team2-score'"
            formControlName="team2Score"
            [min]="0"
            [max]="99"
            [showButtons]="true"
            buttonLayout="horizontal"
            incrementButtonIcon="pi pi-plus"
            decrementButtonIcon="pi pi-minus"
            [step]="1"
            styleClass="score-input"
          >
          </p-inputNumber>
        </div>
      </div>
    </div>

    <!-- Number of Diamonds -->
    <div class="diamonds-section">
      <label for="diamonds-input">Number of Diamonds</label>
      <p-inputNumber
        inputId="diamonds-input"
        formControlName="numberOfDiamonds"
        [min]="1"
        [showButtons]="true"
        buttonLayout="horizontal"
        incrementButtonIcon="pi pi-plus"
        decrementButtonIcon="pi pi-minus"
        [step]="1"
        styleClass="diamonds-input"
      >
      </p-inputNumber>
      @if
      (predictionForm.get('numberOfDiamonds')?.hasError('insufficientDiamonds')
      && predictionForm.get('numberOfDiamonds')?.touched) {
      <small class="error-message"
        >You don't have enough diamonds to bet this amount.</small
      >
      } @if (predictionForm.get('numberOfDiamonds')?.hasError('invalidDiamond')
      && predictionForm.get('numberOfDiamonds')?.touched) {
      <small class="error-message"
        >Unable to verify diamond amount. Please try again.</small
      >
      }
      <!--- @if (predictionForm.get('numberOfDiamonds')?.pending) {
      <small class="validating-message">Validating...</small>
    }-->
    </div>
  </form>

  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button
        label="Cancel"
        icon="pi pi-times"
        (onClick)="onCancel()"
        [outlined]="true"
        severity="secondary"
      />
      <p-button
        [label]="isUpdating() ? 'Update Prediction' : 'Submit Prediction'"
        icon="pi pi-check"
        (onClick)="onSubmit()"
        severity="success"
        [disabled]="predictionForm.invalid || predictionForm.pending"
      />
    </div>
  </ng-template>
</p-dialog>
