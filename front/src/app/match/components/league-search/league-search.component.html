<div class="relative">
  <input
    #searchInput
    type="text"
    [placeholder]="placeholder()"
    class="w-full px-4 py-3 pl-12 bg-white/90 border border-surface-highlight/50 rounded-xl text-gray-900 placeholder:text-gray-500 focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition"
    [value]="searchQuery()"
    (input)="onSearchInput($event)"
  />


  <!-- Clear button -->
  @if (searchQuery().length > 0) {
    <button
      (click)="onClear()"
      class="absolute right-4 top-1/2 -translate-y-1/2 text-text-secondary hover:text-gray-900 transition"
    >
      <span class="material-symbols-outlined">close</span>
    </button>
  }
</div>

<!-- Show All Leagues Button -->
@if (showClearFilterButton()) {
  <div class="mt-3">
    <button
      (click)="onShowAllLeagues()"
      class="w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-primary/10 hover:bg-primary/20 rounded-lg transition text-primary font-semibold"
    >
      <span class="material-symbols-outlined" style="font-size: 20px;">filter_list_off</span>
      <span>Show All Leagues</span>
    </button>
  </div>
}

<!-- Dropdown Results -->
@if (searchQuery().length >= minChars()) {
  <div class="mt-4">
    @if (filteredLeagues().length > 0) {
      <div class="space-y-2 max-h-80 overflow-y-auto custom-scrollbar">
        @for (league of filteredLeagues(); track league.league_key) {
          <button
            (click)="onLeagueClick(league)"
            class="w-full flex items-center gap-3 p-3 bg-surface-highlight/20 hover:bg-surface-highlight/40 rounded-lg transition text-left group"
          >
            <!-- Logo -->
            <div class="h-10 w-10 rounded-lg bg-white/10 p-1.5 flex items-center justify-center flex-shrink-0">
              @if (league.league_logo) {
                <img [src]="league.league_logo" [alt]="league.league_name" class="w-full h-full object-contain" />
              } @else {
                <span class="material-symbols-outlined text-text-secondary">sports_soccer</span>
              }
            </div>

            <!-- Nom et pays -->
            <div class="flex-1 min-w-0">
              <p class="text-gray-900 font-semibold truncate">{{ league.league_name }}</p>
              <p class="text-gray-700 text-sm truncate">{{ league.country_name }}</p>
            </div>

            <!-- Icone de selection -->
            <span class="material-symbols-outlined text-primary group-hover:translate-x-1 transition-transform">
              arrow_forward
            </span>
          </button>
        }
      </div>
    } @else {
      <!-- Pas de resultats -->
      <div class="text-center py-12">
        <span class="material-symbols-outlined text-5xl text-text-secondary mb-3 block">search_off</span>
        <p class="text-gray-900 font-semibold text-lg">No leagues found</p>
        <p class="text-gray-700 mt-1">Try searching for "{{ searchQuery() }}"</p>
      </div>
    }
  </div>
} @else {
  <!-- Hint : taper au moins N caracteres -->
  <div class="mt-4 flex items-center gap-2 text-text-secondary text-sm bg-surface-highlight/10 rounded-lg p-3">
    <span class="material-symbols-outlined text-lg">info</span>
    <p>Type at least {{ minChars() }} characters to search leagues</p>
  </div>
}

